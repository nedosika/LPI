# 104.1 Урок 1

| Сертификат:   | LPIC-1                                      |
|:--------------|:--------------------------------------------|
| Версия:       | 5                                           |
| Тема:         | 104 Устройства, файловые системы Linux, стандарт иерархии файловых систем |                           
| Цель:         | 104.5 Управление правами доступа к файлам |
| Урок:         | 1 из 1                                      |


# Введение

Будучи многопользовательской системой, Linux нужен какой-то способ отслеживать, кому принадлежит каждый файл и разрешено ли 
пользователю выполнять действия с файлом. Это необходимо для обеспечения конфиденциальности пользователей, которые могут 
захотеть сохранить конфиденциальность содержимого своих файлов, а также для обеспечения совместной работы, сделав определенные файлы доступными для нескольких пользователей.

Это делается через трехуровневую систему прав. Каждый файл на диске принадлежит пользователю и группе пользователей и 
имеет три набора разрешений: один для своего владельца, один для группы, которая владеет файлом, и один для всех остальных. 
В этом уроке вы узнаете, как вывести на экран права доступа к файлам, значение этих прав и как ими управлять.


# Запрос информации о файлах и каталогах

Команда `ls` используется для получения списка содержимого любого каталога. В этой базовой форме вы получаете только имена 
файлов:
```
$ ls
Another_Directory  picture.jpg  text.txt
```
Но для каждого файла доступно гораздо больше информации, включая его тип, размер, владельца и многое другое. Чтобы увидеть 
эту информацию, вы должны запросить у `ls` «длинный» листинг, используя параметр `-l`:
```
$ ls -l
total 536
drwxrwxr-x 2 carol carol   4096 Dec 10 15:57 Another_Directory
-rw------- 1 carol carol 539663 Dec 10 10:43 picture.jpg
-rw-rw-r-- 1 carol carol   1881 Dec 10 15:57 text.txt
```
Каждый столбец в выходных данных выше имеет значение. Давайте посмотрим на столбцы, относящиеся к этому уроку.
* Первый *столбец* в листинге показывает тип файла и права доступа. Например, `на drwxrwxr-x`:
    * Первый символ `d` указывает тип файла.
    * Следующие три символа, `rwx`, указывают права доступа для владельца файла, также называемого `пользователем` или `u`.
    * Следующие три символа, `rwx`, указывают права доступа для `группы`, владеющей файлом, также называемой `g`.
    * Последние три символа, `r-x`, обозначают права доступа для всех остальных, также известных как `другие` или `o`.

>Также часто можно услышать, что `другие` права доступа называются правами для всего `мира`, например, «Все остальные в мире имеют эти права доступа».

Во `втором` столбце указано количество жестких ссылок, указывающих на этот файл. `Пятый` столбец показывает размер файла. `Шестой` столбец показывает дату и время последнего изменения файла. Но эти столбцы не актуальны для текущей темы.


# А как насчет каталогов?

Если вы попытаетесь запросить информацию о каталоге с помощью `ls -l`, вместо этого он покажет вам список содержимого каталога:
```
$ ls -l Another_Directory/
total 0
-rw-r--r-- 1 carol carol 0 Dec 10 17:59 another_file.txt
```
Чтобы избежать этого и запросить информацию о самом каталоге, добавьте параметр `-d` в `ls`:
```
$ ls -l -d Another_Directory/
drwxrwxr-x 2 carol carol 4096 Dec 10 17:59 Another_Directory/
```


# Просмотр скрытых файлов

Список каталогов, который мы получили с помощью `ls -l` ранее, неполон:
```
$ ls -l
total 544
drwxrwxr-x 2 carol carol   4096 Dec 10 17:59 Another_Directory
-rw------- 1 carol carol 539663 Dec 10 10:43 picture.jpg
-rw-rw-r-- 1 carol carol   1881 Dec 10 15:57 text.txt
```
В этом каталоге есть еще три файла, но они скрыты. В Linux файлы, имена которых начинаются с точки (`.`), Автоматически скрываются. Чтобы увидеть их, нам нужно добавить параметр `-a` в `ls`:
```
$ ls -l -a
total 544
drwxrwxr-x 3 carol carol   4096 Dec 10 16:01 .
drwxrwxr-x 4 carol carol   4096 Dec 10 15:56 ..
drwxrwxr-x 2 carol carol   4096 Dec 10 17:59 Another_Directory
-rw------- 1 carol carol 539663 Dec 10 10:43 picture.jpg
-rw-rw-r-- 1 carol carol   1881 Dec 10 15:57 text.txt
-rw-r--r-- 1 carol carol      0 Dec 10 16:01 .thisIsHidden
```
Файл `.thisIsHidden` просто скрыт, потому что его имя начинается с `.`.

Директории `.` и `..` особенные. `.` указатель на текущий каталог. А `..` - это указатель на родительский каталог, в котором находится текущий. В Linux каждый каталог содержит по крайней мере эти два каталога.

>Вы можете комбинировать несколько параметров для `ls` (и многих других команд Linux). Например, `ls -l -a` можно записать как `ls -la`.


# Понимание типов файлов

Мы уже упоминали, что первая буква в каждом выводе `ls -l` описывает тип файла. Три наиболее распространенных типа файлов:

`-` (обычный файл)
>Файл может содержать данные любого типа и помогать управлять этими данными. Файлы можно изменять, перемещать, копировать и удалять.

`d` (каталог)
>Каталог содержит другие файлы или каталоги и помогает организовать файловую систему. Технически каталоги - это особый вид файлов.

`l` (символическая ссылка)
>Этот «файл» является указателем на другой файл или каталог в другом месте файловой системы.

В дополнение к ним есть еще три типа файлов, о которых вы должны хотя бы знать, но которые выходят за рамки этого урока:

`b` (блочное устройство)
>В дополнение к ним есть еще три типа файлов, о которых вы должны хотя бы знать, но которые выходят за рамки этого урока:

`c` (символьное устройство)
>Этот файл обозначает виртуальное или физическое устройство. Терминалы (например, основной терминал на ``/dev/ ttyS0) и последовательные порты являются типичными примерами символьных устройств.

`s` (сокет)
>Сокеты служат «проводниками» для передачи информации между двумя программами.

>Не изменяйте никакие разрешения для блочных устройств, символьных устройств или сокетов, если вы не знаете, что делаете. Это может помешать вашей системе работать!


# Понимание прав доступа

В выводе команды `ls -l` права доступа к файлу отображаются сразу после типа файла в виде трех групп по три символа в каждой в порядке `r`, `w` и `x`. Вот что они означают. Имейте в виду, что прочерк - это отсутствие разрешения.


# Права доступа на файлы

`r`
>Обозначает `чтение` и имеет восьмеричное значение `4` (не волнуйтесь, мы скоро обсудим восьмеричные числа). Это означает разрешение на открытие файла и чтение его содержимого.

`w`
>Обозначает `запись` и имеет восьмеричное значение `2`. Это означает разрешение на редактирование или удаление файла.

`x`
>Обозначает `выполнение` и имеет восьмеричное значение `1`. Это означает, что файл может быть запущен как исполняемый файл или сценарий.


# Права доступа на каталоги

`r`
>Обозначает `чтение` и имеет восьмеричное значение `4`. Это означает разрешение на чтение содержимого каталога, например имен файлов. Но это не означает разрешения на чтение самих файлов.

`w`
>Обозначает `запись` и имеет восьмеричное значение `2`. Это означает разрешение на создание или удаление файлов в каталоге или изменение их имен, разрешений и владельцев.

Если у пользователя есть разрешение `w` для каталога, он может изменять права доступа к любому файлу в каталоге (`содержимое` каталога), даже если у пользователя нет разрешений на этот файл или если файл принадлежит другому пользователю.

Имейте в виду, что наличие прав на запись в каталог или файл не означает, что у вас есть разрешение на удаление или переименование самого каталога или файла.

`x`
>Обозначает `выполнение` и имеет восьмеричное значение `1`. Это означает разрешение на вход в каталог, но не на перечисление его файлов (для этого требуется `r`).

Последнее о каталогах может показаться немного запутанным. Представим, например, что у вас есть каталог с именем `Another_Directory` со следующими разрешениями:
```
$ ls -ld Another_Directory/
d--x--x--x 2 carol carol 4,0K Dec 20 18:46 Another_Directory
```
Также представьте, что внутри этого каталога у вас есть сценарий оболочки с именем `hello.sh`:
```
-rwxr-xr-x 1 carol carol 33 Dec 20 18:46 hello.sh
```
Если вы пользователь `carol` и попытаетесь перечислить содержимое `Another_Directory`, вы получите сообщение об ошибке, так как у вашего пользователя нет прав на чтение для этого каталога:
```
$ ls -l Another_Directory/
ls: cannot open directory 'Another_Directory/': Permission denied
```
Однако у пользователя `carol` есть разрешения на выполнение, что означает, что она может войти в каталог. Следовательно, пользователь `carol` может получить доступ к файлам внутри каталога, если у нее есть правильные разрешения для соответствующего файла. Предположим, у пользователя есть полные права доступа (rwx) для скрипта `hello.sh`. Затем она может запустить сценарий, даже если она не может прочитать содержимое каталога, в котором он находится, если ей известно полное имя файла:
```
$ sh Another_Directory/hello.sh
Hello LPI World!
```
Как мы уже говорили ранее, разрешения указываются последовательно: сначала для владельца файла, затем для группы-владельца, а затем для других пользователей. Всякий раз, когда кто-то пытается выполнить действие с файлом, разрешения проверяются таким же образом.

Сначала система проверяет, является ли текущий пользователь владельцем файла, если да, то применяет только первый набор прав. В противном случае он проверяет, принадлежит ли текущий пользователь к группе, владеющей файлом. В этом случае применяется только второй набор прав доступа. В любом другом случае система применит третий набор прав.

Это означает, что если текущий пользователь является владельцем файла, действуют только права доступа владельца, даже если права группы или другие права более высокие, чем права владельца.


# Изменение прав доступа к файлам

Команда `chmod` используется для изменения разрешений для файла и принимает как минимум два параметра: первый описывает, какие права нужно изменить, а второй указывает на файл или каталог, в котором будет сделано изменение. Имейте в виду, что только владелец файла или системный администратор (root) может изменять права доступа к файлу.

Разрешения на изменение можно описать двумя разными способами, или «режимами».

Первый, называемый *symbolic mode*(символьным режимом), предлагает детальный контроль, позволяющий добавлять или отзывать одно разрешение без изменения других в наборе. Другой режим, называемый *octal mode*(восьмеричным), легче запомнить и быстрее использовать, если вы хотите установить все значения разрешений сразу.

Оба режима приведут к одному и тому же конечному результату. Так, например, команды:
```
$ chmod ug+rw-x,o-rwx text.txt
```
и
```
$ chmod 660 text.txt
```
выдаст точно такой же результат, файл с установленными разрешениями:
```
-rw-rw---- 1 carol carol  765 Dec 20 21:25 text.txt
```
Теперь давайте посмотрим, как работает каждый режим.


# Символический режим

При описании разрешений, которые нужно изменить в символьном режиме, первые символы указывают, чьи разрешения вы измените: для пользователя (`u`), для группы (`g`), для других (`o`) и/или для все (`а`).

Затем вам нужно указать команде, что делать: вы можете предоставить разрешение (`+`), отозвать разрешение (`-`) или установить для него определенное значение (`=`).

Наконец, вы указываете, какое разрешение вы хотите использовать: чтение (`r`), запись (`w`) или выполнение (`x`). Например, представьте, что у нас есть файл с именем `text.txt` со следующим набором разрешений:
```
$ ls -l text.txt
-rw-r--r-- 1 carol carol 765 Dec 20 21:25 text.txt
```
Если вы хотите предоставить разрешения на запись членам группы, владеющей файлом, вы должны использовать параметр `g+w`. Будет проще, если вы подумаете об этом так: «Группе (`g`) предоставить (`+`) права на запись (`w`)». Итак, команда будет такой:
```
$ chmod g+w text.txt
```
Давайте проверим результат с помощью `ls`:
```
$ ls -l text.txt
-rw-rw-r-- 1 carol carol 765 Dec 20 21:25 text.txt
```
Вы хотите удалить разрешения на чтение для владельца того же файла? Подумайте об этом так: «Для пользователя (`u`) отозвать (`-`) права на чтение (`r`)». Итак, параметр `u-r`, вот так:
```
$ chmod u-r text.txt
$ ls -l text.txt
--w-rw-r-- 1 carol carol 765 Dec 20 21:25 text.txt
```
Что, если мы хотим установить разрешения точно так же, как `rw-` для всех? Тогда подумайте об этом так: «Для всех (`a`) установите точно (`=`) read (`r`), write (`w`) и no execute (`-`)». Так:
```
$ chmod a=rw- text.txt
$ ls -l text.txt
-rw-rw-rw- 1 carol carol 765 Dec 20 21:25 text.txt
```
Конечно, можно изменить несколько разрешений одновременно. В этом случае разделите их запятой (`,`):
```
$ chmod u+rwx,g-x text.txt
$ ls -lh text.txt
-rwxrw-rw- 1 carol carol 765 Dec 20 21:25 text.txt
```
Приведенный выше пример можно прочитать как: «Для пользователя (`u`) предоставить (`+`) разрешения на чтение, запись и выполнение (`rwx`), для группы (`g`) отменить (`-`) разрешения на выполнение (`x`)».

При запуске в каталоге `chmod` изменяет только разрешения каталога. `chmod` также имеет рекурсивный режим, который полезен, когда вы хотите изменить разрешения для «всех файлов внутри каталога и его подкаталогов». Чтобы использовать это, добавьте параметр `-R` после имени команды перед изменяемыми разрешениями:
```
$ chmod -R u+rwx Another_Directory/
```
Эту команду можно читать как: «Рекурсивно (`-R`), для пользователя (`u`), предоставить (`+`) разрешения на чтение, запись и выполнение (`rwx`)».

>Будьте осторожны и дважды подумайте, прежде чем использовать переключатель `-R`, поскольку легко изменить разрешения для файлов и каталогов, которые вы не хотите изменять, особенно для каталогов с большим количеством файлов и подкаталогов.


# Восьмеричный режим

В *восьмеричном режиме* разрешения указываются по-другому: как трехзначное значение в восьмеричной системе счисления, в системе счисления с основанием 8.

У каждого разрешения есть соответствующее значение, и они указываются в следующем порядке: сначала идет чтение (`r`), которое равно `4`, затем запись (`w`), которое равно `2`, и последнее, выполнение (`x`), представленное `1`. Если разрешения нет, используйте нулевое значение (`0`). Итак, разрешение `rwx` будет `7` (`4+2+1`), а `r-x` будет `5` (`4+0+1`).

Первая из трех цифр в наборе разрешений представляет разрешения для пользователя (`u`), вторая - для группы (`g`), а третья - для других (`o`). Если бы мы хотели установить права доступа для файла на `rw-rw---` - восьмеричное значение было бы `660`:
```
$ chmod 660 text.txt
$ ls -l text.txt
-rw-rw---- 1 carol carol 765 Dec 20 21:25 text.txt
```
Помимо этого, синтаксис в восьмеричном режиме такой же, как и в символьном режиме, первый параметр представляет разрешения, которые вы хотите изменить, а второй параметр указывает на файл или каталог, в котором будет выполнено изменение.
>Если значение разрешения *нечетное*, файл обязательно является исполняемым!

Какой синтаксис использовать? *Восьмеричный режим* рекомендуется, если вы хотите изменить права доступа на определенное значение, например 640 (`rw- r-- ---`). 

*Символьный режим* более полезен, если вы хотите изменить только определенное значение, независимо от текущих прав на файл. Например, вы можете добавить права на выполнение для пользователя, используя только `chmod u+x script.sh`, без учета или даже без учета текущих прав для группы и других.


# Изменение владельца файла

Команда `chown` используется для изменения владельца файла или каталога. Синтаксис довольно прост:
```
chown USERNAME:GROUPNAME FILENAME
```
Например, давайте проверим файл с именем `text.txt`:
```
$ ls -l text.txt
-rw-rw---- 1 carol carol 1881 Dec 10 15:57 text.txt
```
Пользователь, которому принадлежит файл, - `carol`, и группа - также `carol`. Теперь мы изменим группу, владеющую файлом, на другую группу, например, `students`:
```
$ chown carol:students text.txt
$ ls -l text.txt
-rw-rw---- 1 carol students 1881 Dec 10 15:57 text.txt
```
Имейте в виду, что пользователь, владеющий файлом, не обязательно должен принадлежать к группе, владеющей файлом. В приведенном выше примере пользователю `carol` не обязательно быть членом группы `students`.

Права доступа пользователя или группы можно не указывать, если вы не хотите их изменять. Итак, чтобы изменить только группу, владеющую файлом, вы должны использовать `chown :student text.txt`. Чтобы изменить только пользователя, используйте команду `chown carol: text.txt` или просто `chown carol text.txt`. В качестве альтернативы для изменения группы вы можете использовать команду `chgrp student text.txt`.

Если вы не являетесь системным администратором (root), вы не можете передать владельца файла другому пользователю или группе, к которой вы не принадлежите. Если вы попытаетесь это сделать, вы получите сообщение об ошибке `Operation not permitted`.


# Работа с группами

Перед изменением владельца файла может быть полезно узнать, какие группы существуют в системе, какие пользователи являются членами группы и к каким группам принадлежит пользователь.

Чтобы увидеть, какие группы существуют в вашей системе, введите `getent group`. Вывод будет похож на этот (вывод был сокращен):
```
$ getent group
root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:syslog,rigues
tty:x:5:rigues
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:rigues
```
Если вы хотите знать, к каким группам принадлежит пользователь, добавьте имя пользователя в качестве параметра в группы:
```
$ groups carol
carol : carol students cdrom sudo dip plugdev lpadmin sambashare
```
Чтобы сделать обратное (посмотреть, какие пользователи принадлежат к группе), используйте `groupmems`. Параметр `-g` указывает группу, а `-l` перечислит всех ее членов:
```
# groupmems -g cdrom -l
carol
```
>`groupmems` может быть запущен только как root, системный администратор. Если вы в настоящее время не вошли в систему как root, добавьте `sudo` перед командой.


# Права доступа по умолчанию

Попробуем эксперимент. Откройте окно терминала и создайте пустой файл с помощью следующей команды:
```
$ touch testfile
```
Теперь давайте посмотрим на разрешения для этого файла. Они могут отличаться в вашей системе, но предположим, что они выглядят следующим образом:
```
$ ls -lh testfile
-rw-r--r-- 1 carol carol 0 jul 13 21:55 testfile
```
Права: `rw- r-- r--`: *чтение* и *запись* для пользователя и *чтение* для группы и других, или `644` в восьмеричном режиме. Теперь попробуйте создать каталог:
```
$ mkdir testdir
$ ls -lhd testdir
drwxr-xr-x 2 carol carol 4,0K jul 13 22:01 testdir
```
Теперь права равны `rwxr-xr-x`: *чтение*, *запись* и *выполнение* для пользователя, *чтение* и *выполнение* для группы и других или 755 в символьном режиме.

Независимо от того, где вы находитесь в файловой системе, каждый файл или каталог, который вы создаете, получат те же права. Вы когда-нибудь задумывались, откуда они?

Они исходят из маски пользователя или `umask`, которая устанавливает права по умолчанию для каждого создаваемого файла. Вы можете проверить текущие значения с помощью команды umask:
```
$ umask
0022
```
Но это не похоже на `rw-r-- r--` или даже на `644`. Возможно, нам стоит попробовать с параметром `-S`, чтобы получить вывод в символьном режиме:
```
$ umask -S
u=rwx,g=rx,o=rx
```
Это те же права, которые наш тестовый каталог получил в одном из приведенных выше примеров. Но почему, когда мы создавали файл, права доступа были другими?

Что ж, нет смысла устанавливать глобальные разрешения на выполнение для всех в любом файле по умолчанию, верно? Для каталогов требуются разрешения на выполнение (иначе вы не сможете в них попасть), а для файлов - нет, поэтому они их не получают. Следовательно, `rw-r--r--`.

Помимо отображения разрешений по умолчанию, umask также может использоваться для их изменения для текущего сеанса оболочки. Например, если мы воспользуемся командой:
```
$ umask u=rwx,g=rwx,o=
```
Каждый новый каталог унаследует разрешения `rwxrwx---` и каждый файл `rw-rw----` (поскольку они не получают разрешения на выполнение). Если вы повторите приведенные выше примеры, чтобы создать `testfile` и `testdir` и проверить разрешения, вы должны получить:
```
$ ls -lhd test*
drwxrwx--- 2 carol carol 4,0K jul 13 22:25 testdir
-rw-rw---- 1 carol carol    0 jul 13 22:25 testfile
```
И если вы проверите `umask` без параметра `-S`(символьный режим), вы получите:
```
$ umask
0007
```
Результат не выглядит знакомым, потому что используются другие значения. Вот таблица с каждым значением и его соответствующим значением:
|:Значение |:Права доступа к файлам |:Права доступа к директориям |
|:---------|:-----------------------|:----------------------------|
| `0`      | `rw-`                  | `rwx`                       |
| `1`      | `rw-`                  | `rw-`                       |
| `2`      | `r--`                  | `r-x`                       |
| `3`      | `r--`                  | `r--`                       |
| `4`      | `-w-`                  | `-wx`                       |
| `5`      | `-w-`                  | `-w-`                       |
| `6`      | `---`                  | `--x`                       |
| `7`      | `---`                  | `---`                       |

Как видите, `007` соответствует `rwxrwx ---`, как мы и просили. Начальный ноль можно игнорировать.


# Особые права доступа

Помимо разрешений на чтение, запись и выполнение для пользователя, группы и других, каждый файл может иметь *особые права доступа*, которые могут изменять способ работы каталога или выполнение программы. Они могут быть указаны в символьном или восьмеричном формате и выглядят следующим образом:

## Sticky Bit

The Sticky Bit, также *называемый флагом ограниченного удаления*(restricted deletion flag), имеет восьмеричное значение `1` и в символьном режиме представлен буквой `t` в правах доступа для остальных пользователей. Его можно применять только к каталогам и он не влияет на обычные файлы. В Linux он не позволяет пользователям удалять или переименовывать файл в каталоге, если они не владеют этим файлом или каталогом.

Каталоги с установленным Sticky Bit показывают замену `x` на правах для `остальных` при выводе `ls -l`:
```
$ ls -ld Sample_Directory/
drwxr-xr-t 2 carol carol 4096 Dec 20 18:46 Sample_Directory/
```
В восьмеричном режиме особые разрешения указываются с использованием 4-значного обозначения, при этом первая цифра представляет собой специальное право на выполнение. Например, чтобы установить Sticky Bit (значение `1`) для каталога `Another_Directory` в восьмеричном режиме с разрешениями `755`, команда будет выглядеть так:
```
$ chmod 1755 Another_Directory
$ ls -ld Another_Directory
drwxr-xr-t 2 carol carol 4,0K Dec 20 18:46 Another_Directory
```

## SGID

Установка GID, также известный как SGID или бит Set Group ID, имеет восьмеричное значение 2 и в символьном режиме представлен буквой `s` в правах доступа для `группы`. Его можно применять к исполняемым файлам или каталогам. В файлах он заставит процесс запускаться с привилегиями группы, владеющей файлом. При применении к каталогам каждый созданный в нем файл или каталог наследует группу из родительского каталога.

Файлы и каталоги с битом SGID заменяются на `s` вместо `x` в правах доступа для `группы` при выводе `ls -l`:
```
$ ls -l test.sh
-rwxr-sr-x 1 carol carol 33 Dec 11 10:36 test.sh
```
Чтобы добавить разрешения SGID к файлу в символьном режиме, используйте следующую команду:
```
$ chmod g+s test.sh
$ ls -l test.sh
-rwxr-sr-x 1 carol root     33 Dec 11 10:36 test.sh
```
Следующий пример поможет вам лучше понять влияние SGID на каталог. Предположим, у нас есть каталог `Sample_Directory`, принадлежащий пользователю `carol` и группе `users`, со следующей структурой разрешений:
```
$ ls -ldh Sample_Directory/
drwxr-xr-x 2 carol users 4,0K Jan 18 17:06 Sample_Directory/
```
Теперь давайте перейдем в этот каталог и с помощью команды `touch` создадим внутри него пустой файл. Результат будет:
```
$ cd Sample_Directory/
$ touch newfile
$ ls -lh newfile
-rw-r--r-- 1 carol carol 0 Jan 18 17:11 newfile
```
Как мы видим, файл принадлежит пользователю `carol` и группе `carol`. Но если бы для каталога было установлено разрешение SGID, результат был бы другим. Во-первых, давайте добавим бит SGID в `Sample_Directory` и проверим результаты:
```
$ sudo chmod g+s Sample_Directory/
$ ls -ldh Sample_Directory/
drwxr-sr-x 2 carol users 4,0K Jan 18 17:17 Sample_Directory/
```
Символ `s` в разрешениях группы указывает, что бит SGID установлен. Теперь мы перейдем в этот каталог и снова создадим пустой файл с помощью команды `touch`:
```
$ cd Sample_Directory/
$ touch emptyfile
$ ls -lh emptyfile
 -rw-r--r-- 1 carol users 0 Jan 18 17:20 emptyfile
 ```
Группа, которой принадлежит файл, - это `users`. Это связано с тем, что бит SGID заставил файл наследовать группу-владельца своего родительского каталога, то есть `users`.

## SUID

SUID, также известный как Set User ID, имеет восьмеричное значение `4` и представлен буквой `s` в правах доступа для пользователя в символьном режиме. Он применяется только к файлам и не влияет на каталоги. Его поведение аналогично биту SGID, но процесс будет выполняться с привилегиями пользователя, владеющего файлом. Файлы с битом SUID заменяют `x` на `s` в правах для пользователя, при выводе `ls -l`:
```
$ ls -ld test.sh
-rwsr-xr-x 1 carol carol 33 Dec 11 10:36 test.sh
```
Вы можете объединить несколько специальных прав для одного параметра. Итак, чтобы установить SGID (значение `2`) и SUID (значение `4`) в восьмеричном режиме для скрипта `test.sh` с разрешениями `755`, вы должны ввести:
```
$ chmod 6755 test.sh
```
И результат будет:
```
$ ls -lh test.sh
-rwsr-sr-x 1 carol carol 66 Jan 18 17:29 test.sh
```
>Если ваш терминал поддерживает цвет, а в наши дни большинство из них поддерживает, вы можете быстро увидеть, установлены ли эти специальные разрешения, взглянув на вывод `ls -l`. Для sticky bit имя каталога отображаестя черным шрифтом с синим фоном. То же самое относится к файлам с битами SGID (желтый фон) и SUID (красный фон). Цвета могут отличаться в зависимости от того, какой дистрибутив Linux и какие настройки терминала вы используете.


# Упражнения для закрепления

1. Создайте каталог с именем `emptydir`, используя команду `mkdir emptydir`. Теперь, используя `ls`, выведите список разрешений для каталога emptydir.
2. Создайте пустой файл с именем `emptyfile` с помощью команды `touch emptyfile`. Теперь, используя `chmod` в символьном режиме, добавьте разрешения на выполнение для владельца файла `emptyfile` и удалите права доступа на запись и выполнение для всех остальных. Сделайте это, используя только одну команду chmod.
3. Какими будут разрешения по умолчанию для файла, если значение `umask` установлено на `020`?
4. Предположим, файл с именем `test.sh` является сценарием оболочки со следующими разрешениями и владельцем: 
```
-rwxr-sr-x 1 carol root     33 Dec 11 10:36 test.sh
```
* Какие разрешения у владельца файла?
* Используя восьмеричную нотацию, каков будет синтаксис `chmod`, чтобы «отменить» специальное разрешение, предоставленное этому файлу?

5. Рассмотрим этот файл:
```
$ ls -l /dev/sdb1
brw-rw---- 1 root disk 8, 17 Dec 21 18:51 /dev/sdb1
```
Какой тип файла - sdb1? Кто может писать в этот файл?
6. Рассмотрим следующие 4 файла:
```
drwxr-xr-t 2 carol carol 4,0K Dec 20 18:46 Another_Directory
----r--r-- 1 carol carol    0 Dec 11 10:55 foo.bar
-rw-rw-r-- 1 carol carol 1,2G Dec 20 18:22 HugeFile.zip
drwxr-sr-x 2 carol users  4,0K Jan 18 17:26 Sample_Directory
```
Запишите соответствующие разрешения для каждого файла и каталога в восьмеричном режиме с использованием 4-значного обозначения.

`Another_Directory`

`foo.bar`

`HugeFile.zip`

`Sample_Directory`


# Упражнения на размышления


# Ответы на упражнения для закрепления


# Ответы на упражнения для размышления
