# 105.2 Урок 1

| **Сертификат:** | LPIC-1                                      |
|:----------------|:--------------------------------------------|
| **Версия:**     | 5.0                                         |
| **Тема:**       | 105 Оболочки и сценарии оболочки            |                           
| **Цель:**       | 105.2 Настройка и использование среды оболочки |
| **Урок:**       | 2 из 3                                      |


## Введение

Подумайте о переменной как о воображаемом блоке, в который можно временно поместить часть информации. Как и в случае со своими сценариями инициализации, Bash классифицирует переменные как *shell/local* (те, которые живут только в пределах оболочки, в которой они были созданы), так и *environment/global* (те, которые наследуются дочерними оболочками и/или процессами). Фактически, в предыдущем уроке мы рассмотрели оболочки и их сценарии настройки или инициализации. Теперь удобно отметить, что сила этих файлов запуска заключается в том, что они позволяют нам использовать переменные, а также псевдонимы и функции, которые помогают нам создавать и настраивать среду оболочки по нашему выбору.


## Переменные: присвоение и ссылка

Переменная может быть определена как имя, содержащее значение. 

В Bash присвоение значения имени называется *присвоением переменной* и является способом, которым мы создаем или устанавливаем переменные. С другой стороны, процесс доступа к значению, содержащемуся в имени, называется *ссылкой на переменную*. 

Синтаксис для присвоения переменных:

```console
<variable_name>=<variable_value>
```

Например:

```console
$ distro=zorinos
```

Переменная `distro` равна `zorinos`, то есть есть часть памяти, содержащая значение `zorinos`, причем `distro` является указателем на нее. 

Однако обратите внимание, что при присвоении переменной не может быть пробелов по обе стороны от знака равенства:

```console
$ distro =zorinos
-bash: distro: command not found
$ distro= zorinos
-bash: zorinos: command not found
```

Из-за нашей ошибки Bash считал `distro` и `zorinos` командами. 

Для ссылки на переменную (то есть для проверки ее значения) мы используем команду `echo` перед именем переменной со знаком `$`:

```console
$ echo $distro
zorinos
```


## Имена переменных

При выборе имени переменных необходимо учитывать определенные правила. 

Имя переменной может содержать буквы (`a-z`, `A-Z`), цифры (`0-9`) и символы подчеркивания (`_`):

```console
$ distro=zorinos
$ echo $distro
zorinos
$ DISTRO=zorinos
$ echo $DISTRO
zorinos
$ distro_1=zorinos
$ echo $distro_1
zorinos
$ _distro=zorinos
$ echo $_distro
zorinos
```

Он не может начинаться с числа, иначе Bash запутается:

```console
$ 1distro=zorinos
-bash: 1distro=zorinos: command not found
```

Он не может содержать пробелов (даже без кавычек); по соглашению вместо них используются подчеркивания:

```console
$ "my distro"=zorinos
-bash: my: command not found
$ my_distro=zorinos
$ echo $my_distro
zorinos
```


## Значения переменных

Что касается ссылки или значения переменных, также важно учитывать ряд правил. 

Переменные могут содержать любые буквенно-цифровые символы (`a-z`, `A-Z`, `0-9`), а также большинство других символов (`?`,`!`,`*`,`.`,`/` и т. д.):

```console
$ distro=zorin12.4?
$ echo $distro
zorin12.4?
```

Значения переменных должны быть заключены в кавычки, если они содержат одиночные пробелы:

```console
$ distro=zorin 12.4
-bash: 12.4: command not found
$ distro="zorin 12.4"
$ echo $distro
zorin 12.4
$ distro='zorin 12.4'
$ echo $distro
zorin 12.4
```

Значения переменных также должны быть заключены в кавычки, если они содержат такие символы, как те, которые используются для перенаправления (`<`,`>`) или символ вертикальной черты (`|`). Единственное, что делает следующая команда, - это создает пустой файл с именем `zorin`:

```console
$ distro=>zorin
$ echo $distro

$ ls zorin
zorin
```

```console
$ distro=">zorin"
$ echo $distro
>zorin
```

Однако одинарные и двойные кавычки не всегда взаимозаменяемы. В зависимости от того, что мы делаем с переменной (присваивание или ссылка), использование одной или другой имеет последствия и даст разные результаты. В контексте присвоения переменных одинарные кавычки буквально принимают все символы значения переменной, тогда как двойные кавычки допускают замену переменных:

```console
$ lizard=uromastyx
$ animal='My $lizard'
$ echo $animal
My $lizard
$ animal="My $lizard"
$ echo $animal
My uromastyx
```

С другой стороны, при ссылке на переменную, значение которой включает некоторые начальные (или дополнительные) пробелы - иногда в сочетании со звездочками - обязательно использовать двойные кавычки после команды `echo`, чтобы избежать *разделения полей* и *расширения имени пути*:

```console
$ lizard="   genus   |   uromastyx"
$ echo $lizard
genus | uromastyx
$ echo "$lizard"
   genus   |   uromastyx
```

Если ссылка на переменную содержит закрывающий восклицательный знак, это должен быть последний символ в строке (иначе Bash будет думать, что мы имеем в виду событие истории):


```console
$ distro=zorin.?/!os
-bash: !os: event not found
$ distro=zorin.?/!
$ echo $distro
zorin.?/!
```

Любая обратная косая черта должна быть экранирована другой обратной косой чертой. Кроме того, если обратная косая черта является последним символом в строке, и мы не избегаем ее, Bash интерпретирует, что нам нужен разрыв строки, и выдаст нам новую строку:

```console
$ distro=zorinos\
>
$ distro=zorinos\\
$ echo $distro
zorinos\
```

В следующих двух разделах мы суммируем основные различия между *локальными* переменными и переменными *среды*.


## Локальные переменные или переменные оболочки

Локальные переменные или переменные оболочки существуют только в той оболочке, в которой они созданы. По соглашению локальные переменные пишутся строчными буквами. 

Для проведения нескольких тестов создадим локальную переменную. Как объяснялось выше, мы выбираем подходящее имя переменной и приравниваем его к соответствующему значению. Например:

```console
$ reptile=tortoise
```

Давайте теперь используем команду `echo` для ссылки на нашу переменную и проверяем, что все прошло, как ожидалось:

```console
$ echo $reptile
tortoise
```

В определенных сценариях - например, при написании скриптов - неизменяемость может быть интересной особенностью переменных. Если мы хотим, чтобы наши переменные были неизменными, мы можем создать их `readonly`:

```console
$ readonly reptile=tortoise
```

Или поверните их так после того, как они были созданы:

```console
$ reptile=tortoise
$ readonly reptile
```

Теперь, если мы попытаемся изменить значение `reptile`, Bash откажется:

```console
$ reptile=lizard
-bash: distro: readonly variable
```

>Чтобы вывести список всех переменных только для чтения в нашем текущем сеансе, введите в терминал `readonly` или `readonly -p`.

